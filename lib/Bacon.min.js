(function(){var n,t,r,e,u,o,i,s,c,f,a,l,p,h,v,y,m,d,g,b,w,E,M,_,A,S,k,B,P,H,V,D,I,x,O,L,N,C,T,W,j,U,Q,Z,q,$,F,K=[].slice,z={}.hasOwnProperty,G=function(n,t){function r(){this.constructor=n}for(var e in t)z.call(t,e)&&(n[e]=t[e]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},J=function(n,t){return function(){return n.apply(t,arguments)}};"undefined"!=typeof module&&null!==module?(module.exports=n={},n.Bacon=n):this.Bacon=n={},n.fromBinder=function(t,r){return null==r&&(r=Z.id),new i(function(e){var u,i;return u=function(){return i!==void 0&&null!==i?i():setTimeout(function(){return i()},0)},i=t(function(){var t,i,s,c,f,a,l,p;t=arguments.length>=1?K.call(arguments,0):[],f=r.apply(null,t),f instanceof Array&&Z.last(f)instanceof o||(f=[f]);try{for(p=[],a=0,l=f.length;l>a;a++)s=f[a],c=e(s=T(s)),c===n.noMore||s.isEnd()?p.push(u()):p.push(void 0);return p}catch(h){throw i=h,Z.last(f).isEnd()&&u(),i}})})},n.$={asEventStream:function(t,r,e){var u,o=this;return B(r)&&(u=[r,null],e=u[0],r=u[1]),n.fromBinder(function(n){return o.on(t,r,n),function(){return o.off(t,r,n)}},e)}},null!=(q="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:null)&&(q.fn.asEventStream=n.$.asEventStream),n.fromEventTarget=function(t,r,e){var u,o,i,s,c,f;return u=null!=(i=t.addEventListener)?i:null!=(s=t.addListener)?s:t.bind,o=null!=(c=t.removeEventListener)?c:null!=(f=t.removeListener)?f:t.unbind,n.fromBinder(function(n){return u.call(t,r,n),function(){return o.call(t,r,n)}},e)},n.fromPromise=function(t){return n.fromBinder(function(n){return t.then(n,function(t){return n(new u(t))}),function(){return"function"==typeof t.abort?t.abort():void 0}},function(n){return[n,M()]})},n.noMore=["<no-more>"],n.more=["<more>"],n.later=function(t,r){return n.sequentially(t,[r])},n.sequentially=function(t,r){var e;return e=0,n.fromPoll(t,function(){var n;return n=r[e++],r.length>e?n:[n,M()]})},n.repeatedly=function(t,r){var e;return e=0,n.fromPoll(t,function(){return r[e++%r.length]})},n.fromCallback=function(){var t,r;return r=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],n.fromBinder(function(n){return H(r,t)(n),x},function(n){return[n,M()]})},n.fromNodeCallback=function(){var t,r;return r=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],n.fromBinder(function(n){return H(r,t)(n),x},function(n,t){return n?[new u(n),M()]:[t,M()]})},n.fromPoll=function(t,r){return n.fromBinder(function(n){var r;return r=setInterval(n,t),function(){return clearInterval(r)}},r)},n.interval=function(t,r){return null==r&&(r={}),n.fromPoll(t,function(){return I(r)})},n.constant=function(n){return new l(N([n],S))},n.never=function(){return n.fromArray([])},n.once=function(t){return n.fromArray([t])},n.fromArray=function(n){return new i(N(n,I))},N=function(n,t){return function(r){var e,u,o;for(u=0,o=n.length;o>u;u++)e=n[u],r(t(e));return r(M()),x}},n.combineAll=function(n,t){var r,e,u,o,i;for(m(n),e=Z.head(n),i=Z.tail(n),u=0,o=i.length;o>u;u++)r=i[u],e=t(e,r);return e},n.mergeAll=function(t){return n.combineAll(t,function(n,t){return n.merge(t)})},n.combineAsArray=function(){var t,r,e,u;return e=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],e instanceof Array||(e=[e].concat(t)),e.length?(u=function(){var n,t,u;for(u=[],n=0,t=e.length;t>n;n++)r=e[n],u.push(f);return u}(),new l(function(t){var o,i,s,c,f,a,l,p,v,y,m,d;for(y=!1,v=function(){var n,t,u;for(u=[],n=0,t=e.length;t>n;n++)r=e[n],u.push(x);return u}(),p=function(){var n,t,r;for(t=0,r=v.length;r>t;t++)n=v[t],n();return y=!0},s=function(){var n,t,u;for(u=[],n=0,t=e.length;t>n;n++)r=e[n],u.push(!1);return u}(),o=function(){var r;return Z.all(s)?(r=t(M()),r===n.noMore&&p(),r):void 0},f=!1,i=function(r,e){return function(i){var s,c;return i.isEnd()?(r(),o(),n.noMore):i.isError()?(s=t(i),s===n.noMore&&p(),s):(e(i.value),Z.all(Z.map(function(n){return n.isDefined},u))?f&&i.isInitial()?n.more:(f=!0,c=function(){var n,t,r,e;for(e=[],t=0,r=u.length;r>t;t++)n=u[t],e.push(n.get()());return e},s=t(i.apply(c)),s===n.noMore&&p(),s):n.more)}},a=function(n){return i(function(){return s[n]=!0},function(t){return u[n]=new h(t)})},c=m=0,d=e.length;d>m;c=++m)l=e[c],y||(v[c]=l.subscribe(a(c)));return p})):n.constant([])},n.combineWith=function(t,r){return n.combineAll(t,function(n,t){return n.toProperty().combine(t,r)})},n.combineTemplate=function(t){var r,e,u,o,i,s,c,f,l,p;return c=[],p=[],s=function(n){return n[n.length-1]},l=function(n,t,r){return s(n)[t]=r},r=function(n,t){return function(r,e){return l(r,n,e[t])}},i=function(n,t){return function(r){return l(r,n,t)}},f=function(n){return n instanceof Array?[]:{}},u=function(n,t){var e,u;return t instanceof a?(p.push(t),c.push(r(n,p.length-1))):"object"==typeof t?(u=function(n){return function(r){var e;return e=f(t),l(r,n,e),r.push(e)}},e=function(n){return n.pop()},c.push(u(n)),o(t),c.push(e)):c.push(i(n,t))},o=function(n){return Z.each(n,u)},o(t),e=function(n){var r,e,u,o,i;for(u=f(t),r=[u],o=0,i=c.length;i>o;o++)e=c[o],e(r,n);return u},n.combineAsArray(p).map(e)},o=function(){function n(){}return n.prototype.isEvent=function(){return!0},n.prototype.isEnd=function(){return!1},n.prototype.isInitial=function(){return!1},n.prototype.isNext=function(){return!1},n.prototype.isError=function(){return!1},n.prototype.hasValue=function(){return!1},n.prototype.filter=function(){return!0},n.prototype.onDone=function(n){return n()},n}(),c=function(n){function t(n){var t=this;this.value=B(n)?function(){var r;return r=n(),t.value=Z.always(r),r}:Z.always(n)}return G(t,n),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.fmap=function(n){var t=this;return this.apply(function(){return n(t.value())})},t.prototype.apply=function(n){return new t(n)},t.prototype.filter=function(n){return n(this.value())},t.prototype.describe=function(){return this.value()},t}(o),s=function(n){function t(){return $=t.__super__.constructor.apply(this,arguments)}return G(t,n),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(n){return new t(n)},t.prototype.toNext=function(){return new c(this.value)},t}(c),e=function(n){function t(){return F=t.__super__.constructor.apply(this,arguments)}return G(t,n),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<end>"},t}(o),u=function(n){function t(n){this.error=n}return G(t,n),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.describe=function(){return"<error> "+this.error},t}(o),a=function(){function t(){this.flatMapLatest=J(this.flatMapLatest,this),this.scan=J(this.scan,this),this.takeUntil=J(this.takeUntil,this);var n;this.assign=this.onValue,n=this,this.is={self:n},this.where={self:n}}return t.prototype.onValue=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.subscribe(function(n){return n.hasValue()?t(n.value()):void 0})},t.prototype.onValues=function(n){return this.onValue(function(t){return n.apply(null,t)})},t.prototype.onError=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.subscribe(function(n){return n.isError()?t(n.error):void 0})},t.prototype.onEnd=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.subscribe(function(n){return n.isEnd()?t():void 0})},t.prototype.errors=function(){return this.filter(function(){return!1})},t.prototype.filter=function(){var t,r;return r=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],r instanceof l?r.sampledBy(this,function(n,t){return[n,t]}).filter(function(n){var t,r;return t=n[0],r=n[1],t}).map(function(n){var t,r;return t=n[0],r=n[1]}):(r=H(r,t),this.withHandler(function(t){return t.filter(r)?this.push(t):n.more}))},t.prototype.takeWhile=function(){var t,r;return r=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],r=H(r,t),this.withHandler(function(t){return t.filter(r)?this.push(t):(this.push(M()),n.noMore)})},t.prototype.endOnError=function(){return this.withHandler(function(n){return n.isError()?(this.push(n),this.push(M())):this.push(n)})},t.prototype.take=function(t){return y("take: count must >= 1",t>=1),this.withHandler(function(r){return r.hasValue()?(t--,t>0?this.push(r):(this.push(r),this.push(M()),n.noMore)):this.push(r)})},t.prototype.map=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.withHandler(function(n){return this.push(n.fmap(t))})},t.prototype.mapError=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.withHandler(function(n){return n.isError()?this.push(I(t(n.error))):this.push(n)})},t.prototype.mapEnd=function(){var t,r;return r=arguments[0],t=arguments.length>=2?K.call(arguments,1):[],r=H(r,t),this.withHandler(function(t){return t.isEnd()?(this.push(I(r(t))),this.push(M()),n.noMore):this.push(t)})},t.prototype.doAction=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t=H(t,n),this.withHandler(function(n){return n.hasValue()&&t(n.value()),this.push(n)})},t.prototype.takeUntil=function(t){var r;return r=this,this.withSubscribe(function(e){var u,o,i,s,c,f;return f=!1,s=x,c=x,i=function(){return s(),c(),f=!0},u=function(t){return t.isEnd()?(c(),e(t),n.noMore):(t.onDone(function(){var r;return f||(r=e(t),r!==n.noMore)?void 0:i()}),n.more)},o=function(t){return t.isError()?n.more:t.isEnd()?n.noMore:(s(),e(M()),n.noMore)},s=r.subscribe(u),f||(c=t.subscribe(o)),i})},t.prototype.skip=function(t){return y("skip: count must >= 0",t>=0),this.withHandler(function(r){return r.hasValue()?t>0?(t--,n.more):this.push(r):this.push(r)})},t.prototype.skipDuplicates=function(n){return null==n&&(n=function(n,t){return n===t}),this.withStateMachine(f,function(t,r){return r.hasValue()?t!==f&&n(t.get(),r.value())?[t,[]]:[new h(r.value()),[r]]:[t,[r]]})},t.prototype.withStateMachine=function(t,r){var e;return e=t,this.withHandler(function(t){var u,o,i,s,c,f,a;for(u=r(e,t),o=u[0],s=u[1],e=o,c=n.more,f=0,a=s.length;a>f;f++)if(i=s[f],c=this.push(i),c===n.noMore)return c;return c})},t.prototype.scan=function(t,r){var e,u,o=this;return r=C(r),e=U(t),u=function(t){var u,i;return u=!1,i=o.subscribe(function(o){return o.hasValue()?u&&o.isInitial()?n.more:(u=!0,e=new h(r(e.getOrElse(void 0),o.value())),t(o.apply(Z.always(e.get())))):(o.isEnd()&&(u=!0),t(o))}),u||e.forEach(function(r){var e;return e=t(S(r)),e===n.noMore?(i(),i=x):void 0}),i},new l(new p(u).subscribe)},t.prototype.diff=function(n,t){return t=C(t),this.scan([n],function(n,r){return[r,t(n[0],r)]}).filter(function(n){return 2===n.length}).map(function(n){return n[1]})},t.prototype.flatMap=function(t){var r;return t=V(t),r=this,new i(function(e){var u,o,i,c,f,a;return o=[],i=!1,a=function(){},f=function(){var n,t,r;for(a(),t=0,r=o.length;r>t;t++)n=o[t],n();return o=[]},u=function(){return i&&0===o.length?e(M()):void 0},c=function(r){var c,a,l,p,h;return r.isEnd()?(i=!0,u()):r.isError()?e(r):(c=t(r.value()),h=void 0,a=!1,p=function(){return null!=h&&L(h,o),u()},l=function(t){var r;return t.isEnd()?(p(),a=!0,n.noMore):(t instanceof s&&(t=t.toNext()),r=e(t),r===n.noMore&&f(),r)},h=c.subscribe(l),a?void 0:o.push(h))},a=r.subscribe(c),f})},t.prototype.flatMapLatest=function(n){var t;return n=V(n),t=this.toEventStream(),t.flatMap(function(r){return n(r).takeUntil(t)})},t.prototype.not=function(){return this.map(function(n){return!n})},t.prototype.log=function(){var n;return n=arguments.length>=1?K.call(arguments,0):[],this.subscribe(function(t){return console.log.apply(console,K.call(n).concat([t.describe()]))}),this},t.prototype.slidingWindow=function(n){return this.scan([],function(t,r){return t.concat([r]).slice(-n)})},t}(),i=function(t){function e(n){var t;e.__super__.constructor.call(this),g(n),t=new r(n),this.subscribe=t.subscribe,this.hasSubscribers=t.hasSubscribers}return G(e,t),e.prototype.map=function(){var n,t;return t=arguments[0],n=arguments.length>=2?K.call(arguments,1):[],t instanceof l?t.sampledBy(this,_):e.__super__.map.apply(this,[t].concat(K.call(n)))},e.prototype.delay=function(t){return this.flatMap(function(r){return n.later(t,r)})},e.prototype.debounce=function(t){return this.flatMapLatest(function(r){return n.later(t,r)})},e.prototype.throttle=function(n){return this.bufferWithTime(n).map(function(n){return n[n.length-1]})},e.prototype.bufferWithTime=function(n){var t;return t=function(n){return n.schedule()},this.buffer(n,t,t)},e.prototype.bufferWithCount=function(n){var t;return t=function(t){return t.values.length===n?t.flush():void 0},this.buffer(0,t)},e.prototype.buffer=function(t,r,e){var u,o,i;return null==r&&(r=function(){}),null==e&&(e=function(){}),u={scheduled:!1,end:null,values:[],flush:function(){var t;if(this.scheduled=!1,this.values.length>0){if(t=this.push(I(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(t!==n.noMore)return e(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){var n=this;return this.scheduled?void 0:(this.scheduled=!0,t(function(){return n.flush()}))}},i=n.more,B(t)||(o=t,t=function(n){return setTimeout(n,o)}),this.withHandler(function(n){return u.push=this.push,n.isError()?i=this.push(n):n.isEnd()?(u.end=n,u.scheduled||u.flush()):(u.values.push(n.value()),r(u)),i})},e.prototype.merge=function(t){var r;return r=this,new e(function(e){var u,o,i,s,c,f;return s=x,c=x,f=!1,i=function(){return s(),c(),f=!0},u=0,o=function(t){var r;return t.isEnd()?(u++,2===u?e(M()):n.more):(r=e(t),r===n.noMore&&i(),r)},s=r.subscribe(o),f||(c=t.subscribe(o)),i})},e.prototype.toProperty=function(n){return 0===arguments.length&&(n=f),this.scan(n,P)},e.prototype.toEventStream=function(){return this},e.prototype.concat=function(n){var t;return t=this,new e(function(r){var e;return e=t.subscribe(function(t){return t.isEnd()?e=n.subscribe(r):r(t)}),function(){return e()}})},e.prototype.awaiting=function(n){return this.map(!0).merge(n.map(!1)).toProperty(!1)},e.prototype.startWith=function(t){return n.once(t).concat(this)},e.prototype.withHandler=function(n){var t;return t=new r(this.subscribe,n),new e(t.subscribe)},e.prototype.withSubscribe=function(n){return new e(n)},e}(a),l=function(t){function r(t){var e,u=this;this.subscribe=t,this.toEventStream=J(this.toEventStream,this),this.toProperty=J(this.toProperty,this),this.changes=J(this.changes,this),this.sample=J(this.sample,this),r.__super__.constructor.call(this),e=function(t,e,o){var i,s;return i=f,s=f,new r(function(r){var c,f,a,l,p,v,y,m,d,g,b;return b=!1,d=x,g=x,m=function(){return d(),g(),b=!0},l=!1,v=!1,c=function(){var t;return l&&v?(t=r(M()),t===n.noMore&&m(),t):void 0},a=!1,f=function(t,e,u){return function(o){var f;return o.isEnd()?(t(),c(),n.noMore):o.isError()?(f=r(o),f===n.noMore&&m(),f):(e(new h(o.value)),i.isDefined&&s.isDefined?a&&o.isInitial()?n.more:(a=!0,f=u(r,o,i.value,s.value),f===n.noMore&&m(),f):n.more)}},p=f(function(){return l=!0},function(n){return i=n},e),y=f(function(){return v=!0},function(n){return s=n},o),d=u.subscribe(p),b||(g=t.subscribe(y)),m})},this.combine=function(t,r){var e;return e=C(r),n.combineAsArray(u,t).map(function(n){return e(n[0],n[1])})},this.sampledBy=function(n,t){var r,u;return null==t&&(t=_),t=C(t),r=function(n,r,e,u){return n(r.apply(function(){return t(e(),u())}))},u=e(n,x,r),n instanceof i&&(u=u.changes()),u.takeUntil(n.filter(!1).mapEnd())}}return G(r,t),r.prototype.sample=function(t){return this.sampledBy(n.interval(t,{}))},r.prototype.changes=function(){var n=this;return new i(function(t){return n.subscribe(function(n){return n.isInitial()?void 0:t(n)})})},r.prototype.withHandler=function(n){return new r(new p(this.subscribe,n).subscribe)},r.prototype.withSubscribe=function(n){return new r(new p(n).subscribe)},r.prototype.toProperty=function(){return b(arguments),this},r.prototype.toEventStream=function(){var n=this;return new i(function(t){return n.subscribe(function(n){return n.isInitial()&&(n=n.toNext()),t(n)})})},r.prototype.and=function(n){return this.combine(n,function(n,t){return n&&t})},r.prototype.or=function(n){return this.combine(n,function(n,t){return n||t})},r.prototype.decode=function(t){return this.combine(n.combineTemplate(t),function(n,t){return t[n]})},r.prototype.delay=function(n){return this.delayChanges(function(t){return t.delay(n)})},r.prototype.debounce=function(n){return this.delayChanges(function(t){return t.debounce(n)})},r.prototype.throttle=function(n){return this.delayChanges(function(t){return t.throttle(n)})},r.prototype.delayChanges=function(n){return v(this,n(this.changes()))},r}(a),v=function(t,r){var e;return e=function(t){var r;return r=f,t.subscribe(function(t){return t.isInitial()&&(r=new h(t.value())),n.noMore}),r},r.toProperty(e(t))},r=function(){function t(t,r){var e,u,i,s,c,f,a,l,p,h=this;null==t&&(t=function(){return x}),a=[],c=null,s=!1,i=!1,this.hasSubscribers=function(){return a.length>0},l=x,f=function(n){return a=Z.without(n,a)},p=null,u=function(n){var t,r,e,u;if(null!=p)for(r=p,p=null,e=0,u=r.length;u>e;e++)t=r[e],t();return n.onDone=o.prototype.onDone},e=function(n){return p=(p||[]).concat([n])},this.push=function(t){var r,o,i,l,p,v;if(s)return c=(c||[]).concat([t]),n.more;try{for(s=!0,t.onDone=e,l=a,p=0,v=l.length;v>p;p++)i=l[p],o=i(t),(o===n.noMore||t.isEnd())&&f(i)}catch(y){throw r=y,c=null,r}finally{s=!1}for(;null!=c?c.length:void 0;)t=Z.head(c),c=Z.tail(c),h.push(t);return u(t),h.hasSubscribers()?n.more:n.noMore},null==r&&(r=function(n){return this.push(n)}),this.handleEvent=function(n){return n.isEnd()&&(i=!0),r.apply(h,[n])},this.subscribe=function(n){return i?(n(M()),x):(g(n),a=a.concat(n),1===a.length&&(l=t(h.handleEvent)),g(l),function(){return f(n),h.hasSubscribers()?void 0:l()})}}return t}(),p=function(t){function r(t,e){var u,o,i,s=this;r.__super__.constructor.call(this,t,e),u=f,i=this.push,t=this.subscribe,o=!1,this.push=function(n){return n.isEnd()&&(o=!0),n.hasValue()&&(u=new h(n.value())),i.apply(s,[n])},this.subscribe=function(r){var e,i,c;return e=!1,c=function(){return s.hasSubscribers()||o},i=u.filter(c).map(function(n){return r(S(n))}),i.getOrElse(n.more)===n.noMore?x:o?(r(M()),x):t.apply(s,[r])}}return G(r,t),r}(r),t=function(t){function r(){var t,e,o,i,s,c,f,a;o=void 0,c=[],t=!1,e=function(t){return function(r){return r.isEnd()?(a(t),n.noMore):o(r)}},f=function(){var n,t,r,e;for(e=[],t=0,r=c.length;r>t;t++)n=c[t],e.push("function"==typeof n.unsub?n.unsub():void 0);return e},s=function(n){return n.unsub=n.input.subscribe(e(n.input))},a=function(n){var t,r,e,u;for(t=e=0,u=c.length;u>e;t=++e)if(r=c[t],r.input===n)return"function"==typeof r.unsub&&r.unsub(),c.splice(t,1),void 0},i=function(n){var t,r,e,u,i;for(o=n,r=[],i=E(c),e=0,u=i.length;u>e;e++)t=i[e],s(t);return f},r.__super__.constructor.call(this,i),this.plug=function(n){var r;if(!t)return r={input:n},c.push(r),null!=o&&s(r),function(){return a(n)}},this.push=function(n){return"function"==typeof o?o(I(n)):void 0},this.error=function(n){return"function"==typeof o?o(new u(n)):void 0},this.end=function(){return t=!0,f(),"function"==typeof o?o(M()):void 0}}return G(r,t),r}(i),h=function(){function n(n){this.value=n}return n.prototype.getOrElse=function(){return this.value},n.prototype.get=function(){return this.value},n.prototype.filter=function(t){return t(this.value)?new n(this.value):f},n.prototype.map=function(t){return new n(t(this.value))},n.prototype.forEach=function(n){return n(this.value)},n.prototype.isDefined=!0,n.prototype.toArray=function(){return[this.value]},n}(),f={getOrElse:function(n){return n},filter:function(){return f},map:function(){return f},forEach:function(){},isDefined:!1,toArray:function(){return[]}},n.EventStream=i,n.Property=l,n.Observable=a,n.Bus=t,n.Initial=s,n.Next=c,n.End=e,n.Error=u,x=function(){},P=function(n,t){return t},_=function(n){return n},S=function(n){return new s(Z.always(n))},I=function(n){return new c(Z.always(n))},M=function(){return new e},T=function(n){return n instanceof o?n:I(n)},E=function(n){return n.slice(0)},A=Array.prototype.indexOf?function(n,t){return n.indexOf(t)}:function(n,t){var r,e,u,o;for(r=u=0,o=n.length;o>u;r=++u)if(e=n[r],t===e)return r;return-1},L=function(n,t){var r;return r=A(t,n),r>=0?t.splice(r,1):void 0},y=function(n,t){if(!t)throw n},d=function(n){return y("not an event : "+n,n instanceof o&&n.isEvent())},g=function(n){return y("not a function : "+n,B(n))},B=function(n){return"function"==typeof n},m=function(n){return y("not an array : "+n,n instanceof Array)},b=function(n){return y("no arguments supported",0===n.length)},w=function(n){return y("not a string : "+n,"string"==typeof n)},D=function(n,t,r){return w(t),void 0===r&&(r=[]),function(e){return n[t].apply(n,r.concat([e]))}},O=function(n,t){return function(){var r;return r=arguments.length>=1?K.call(arguments,0):[],n.apply(null,t.concat(r))}},V=function(n){return n instanceof a&&(n=Z.always(n)),g(n),n},H=function(n,t){return B(n)?t.length?O(n,t):n:k(n)?W(n,t):"object"==typeof n&&t.length?D(n,Z.head(t),Z.tail(t)):Z.always(n)},k=function(n){return"string"==typeof n&&n.length>1&&"."===n.charAt(0)},n.isFieldKey=k,W=function(n,t){var r,e;return e=n.slice(1).split("."),r=Z.map(Q(t),e),function(t){var e,u;for(e=0,u=r.length;u>e;e++)n=r[e],t=n(t);return t}},Q=function(n){return function(t){return function(r){var e;return e=r[t],B(e)?e.apply(r,n):e}}},j=function(n){return n.slice(1)},C=function(n){var t;return B(n)?n:k(n)?(t=j(n),function(n,r){return n[t](r)}):y("not a function or a field key: "+n,!1)},U=function(n){return n instanceof h||n===f?n:new h(n)},"undefined"!=typeof define&&null!==define&&null!=define.amd&&"function"==typeof define&&define(function(){return n}),Z={head:function(n){return n[0]},always:function(n){return function(){return n}},empty:function(n){return 0===n.length},tail:function(n){return n.slice(1,n.length)},filter:function(n,t){var r,e,u,o;for(r=[],u=0,o=t.length;o>u;u++)e=t[u],n(e)&&r.push(e);return r},map:function(n,t){var r,e,u,o;for(o=[],e=0,u=t.length;u>e;e++)r=t[e],o.push(n(r));return o},each:function(n,t){var r,e,u;u=[];for(r in n)e=n[r],u.push(t(r,e));return u},toArray:function(n){return n instanceof Array?n:[n]},contains:function(n,t){return-1!==A(n,t)},id:function(n){return n},last:function(n){return n[n.length-1]},all:function(n){var t,r,e;for(r=0,e=n.length;e>r;r++)if(t=n[r],!t)return!1;return!0},without:function(n,t){return Z.filter(function(t){return t!==n},t)}},n._=Z}).call(this);